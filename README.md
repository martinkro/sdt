SDT 安全数据类型
===

## 1 背景

在游戏开发中，由于某些原因（网络、性能等）导致部分游戏逻辑判断在客户端本地执行，如某些手游的战斗计算。即网络游戏中某些逻辑单机化。内存修改器（如烧饼修改器、葫芦侠修改器等）成为部分手机游戏最大威胁之一。

安全数据类型是针对主流修改器的实现原理而开发的供基于C++开发的游戏专用的反内存修改器的一套数据加密方案。

## 2 原理

### 主流修改器主要有以下几大功能：

- 基础数据搜索：首先搜索一个特定的数值，比如金钱100，待金钱变化后，比如110再搜索110，如此重复几步，内存修改器就能定位到金钱所在的内存地址，然后修改即可。

- 模糊搜索：在游戏中存在没有明确数值的属性，如柱状血量，可通过搜索“变大”、“变小”、“变化了”、“不变”等操作进行内存筛选，如此重复几步，即可定位到目标数据的内存地址，然后修改即可。

- 反加密搜索：与基础数据搜索一致，增加了对简单加密的数据进行定位，主要是两类加密y=a*x+b和y=a^x+b

- 联合搜索：将游戏中的多个相邻（只要内存地址相隔不远都可以认为是相邻，一般是0-255字节）属性一起搜索，可以快速定位目标数据。**在使用安全数据类型中特别需要注意的就是在保护相关属性的时，需要将与该属性相邻的属性一起保护**。

### 原理
- 主流修改器实现基于一个假设，待修改的目标数据在定位过程中，在内存的位置是不变的。

- 安全数据类型实现了待保护的数据在内存的位置随目标数据的改变而改变。

- 安全数据类型能对抗主流修改器也基于一个假设，修改器不能搜索一次就能定位到目标数据。


## 3 如何使用

### 使用例子

如游戏客户端工程里有一个类Player

Player.h

	#ifndef __PLAYER_H__
	#define __PLAYER_H__
	
	class Player
	{
	public:
		Player(){}
	private:
		int m_hp;
		float m_mp;
	}
	
	#endif

使用安全数据类型后：

	 #ifndef __PLAYER_H__
	 #define __PLAYER_H__
	 
	 #include "sdt.h"
	 class Player
	 {
	 public:
	 	Player(){}
	 private:
	 	sdt_int m_hp;
	 	sdt_float m_mp;
	 }
	 
	 #endif
	 
### 支持的基础数据类型

| 原生数据类型   | 安全数据类型 |
|--------------|------------|
|char          |sdt_char    |
|unsigned char |sdt_uchar   |
|short         |sdt_short   |
|unsigned short|sdt_ushort  |
|int           |sdt_int     |
|unsigned int  |sdt_uint    |
|long          |sdt_long    |
|unsigned long |sdt_ulong   |
|float         |sdt_float   |
|double        |sdt_double  |





	 





